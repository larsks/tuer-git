<?xml version="1.0"?>

<!-- ===================================================================== -->
<!-- TUER                                                                  -->
<!-- Ant 1.5 build file                                                    -->
<!-- ===================================================================== -->

<project name="TUER" default="build" basedir=".">
	<!-- directory containing signed JARs, JNPL files and images that are used in the deployed product -->
	<property name="deploymentdestdir" value="target"/>
	<!-- intermediary directory containing JARs that are going to be signed -->
	<property name="destdir" value="."/>
	<!-- directory containing the source code -->
	<property name="srcdir" value="."/>
	<property name="homepage-url" value="http://tuer.sourceforge.net" />
	<property name="codebase-url" value="${homepage-url}/very_experimental/" />
	<property name="vendor" value="Julien GOUESSE" />
	<property name="alias" value="gouessej"/>
	<property name="keystore" value="key"/>
	<property name="tuer-main-class" value="engine.service.Ardor3DGameServiceProvider"/>
	<property name="tuer-jnlp-filename" value="tuer.jnlp" />
	<property name="tuer-jar-filename" value="tuer.jar" />
	<property name="tuer-chrome-web-store-zip-filename" value="tuer_chrome_web_store.zip" />
	<!-- DO NOT CHANGE THIS NAME or Chrome web store won't find your manifest -->
	<property name="tuer-chrome-web-store-manifest-filename" value="manifest.json" />
	<!-- DO NOT CHANGE THIS NAME or Chrome web store won't find your icon -->
	<property name="tuer-chrome-web-store-icon-filename" value="icon_128.png" />
	<property name="jfpsm-main-class" value="connection.JFPSMServiceProvider"/>
	<property name="jfpsm-jnlp-filename" value="jfpsm.jnlp" />
	<property name="jfpsm-jar-filename" value="jfpsm.jar" />
	<path id="project.class.path">
	    <!-- N.B: do not add java.class.path -->
		<pathelement path="${destdir}"/>
		<pathelement location="lib/ardor3d/ardor3d-animation-0.8-SNAPSHOT.jar"/>
		<pathelement location="lib/ardor3d/ardor3d-collada-0.8-SNAPSHOT.jar"/>
		<pathelement location="lib/ardor3d/ardor3d-core-0.8-SNAPSHOT.jar"/>		
		<pathelement location="lib/fettle/fettle-0.4.5.jar"/>
		<pathelement location="lib/google-collect/guava-r08.jar"/>
		<pathelement location="lib/mockachino/mockachino-full-0.3.1.jar"/>
		<pathelement location="lib/ardor3d/ardor3d-extras-0.8-SNAPSHOT.jar"/>
		<pathelement location="lib/ardor3d/ardor3d-awt-0.8-SNAPSHOT.jar"/>
		<pathelement location="lib/ardor3d/ardor3d-jogl-0.8-SNAPSHOT.jar"/>
		<pathelement location="lib/jogl/jogl.jar"/>
		<pathelement location="lib/jogl/gluegen-rt.jar"/>
		<pathelement location="lib/ardor3d/ardor3d-ui-0.8-SNAPSHOT.jar"/>
		<pathelement location="lib/pss/CodecJOrbis.jar"/>
		<pathelement location="lib/pss/LibraryJavaSound.jar"/>
		<pathelement location="lib/pss/SoundSystem.jar"/>
	</path>
	<path id="project.lib.path">
	    <pathelement location="lib/ardor3d/ardor3d-animation-0.8-SNAPSHOT.jar"/>
	    <pathelement location="lib/ardor3d/ardor3d-collada-0.8-SNAPSHOT.jar"/>
	    <pathelement location="lib/ardor3d/ardor3d-core-0.8-SNAPSHOT.jar"/>     
	    <pathelement location="lib/fettle/fettle-0.4.5.jar"/>
	    <pathelement location="lib/google-collect/guava-r08.jar"/>
	    <pathelement location="lib/mockachino/mockachino-full-0.3.1.jar"/>
	    <pathelement location="lib/ardor3d/ardor3d-extras-0.8-SNAPSHOT.jar"/>
	    <pathelement location="lib/ardor3d/ardor3d-awt-0.8-SNAPSHOT.jar"/>
	    <pathelement location="lib/ardor3d/ardor3d-jogl-0.8-SNAPSHOT.jar"/>
	    <pathelement location="lib/jogl/jogl.jar"/>
	    <pathelement location="lib/jogl/gluegen-rt.jar"/>
	    <pathelement location="lib/ardor3d/ardor3d-ui-0.8-SNAPSHOT.jar"/>
	    <pathelement location="lib/pss/CodecJOrbis.jar"/>
	    <pathelement location="lib/pss/LibraryJavaSound.jar"/>
	    <pathelement location="lib/pss/SoundSystem.jar"/>
	</path>
	<target name="check-java-version" description="Checks the Java version">
		<fail message="Please use Java SDK 1.6 or higher.">
		    <condition>
		        <not>		            
		            <or>
		                <equals arg1="${ant.java.version}" arg2="1.6" />
		                <equals arg1="${ant.java.version}" arg2="1.7" />
		            </or>		                		            
		        </not>
		    </condition>
        </fail>
	</target>
	<condition property="is-linux-amd64">
	    <and>
	        <os name="Linux" />
	    	<or>
	    		<os arch="amd64" />
	    		<os arch="x86_64" />
	    	</or>
	    </and>
	</condition>
	<condition property="is-linux-i586">
		<and>
		    <os name="Linux" />
			<or>
		        <os arch="i386" />
				<os arch="i586" />
				<os arch="x86" />
			</or>
		</and>
	</condition>
	<condition property="is-windows-amd64">
		<and>
		    <os family="windows" />
			<or>
		        <os arch="amd64" />
				<os arch="x86_64" />
			</or>
		</and>
	</condition>
	<condition property="is-windows-i586">
		<and>
			<os family="windows" />
			<or>
			    <os arch="i386" />
			    <os arch="i586" />
				<os arch="x86" />
			</or>
		</and>
	</condition>
	<condition property="is-macosx-universal">
		<and>
			<os name="Mac OS X" />			
			<not>
				<os arch="ppc" />
			</not>
		</and>
	</condition>
	<condition property="is-macosx-ppc">
		<and>
			<os name="Mac OS X" />			
			<os arch="ppc" />
		</and>
	</condition>
	<target name="set-jogl-library-path-linux-amd64" if="is-linux-amd64">
		<property name="jogl.library.path" value="lib/jogl/native/linux-amd64/" />
	</target>
	<target name="set-jogl-library-path-linux-i586" if="is-linux-i586">
		<property name="jogl.library.path" value="lib/jogl/native/linux-i586/" />
	</target>
	<target name="set-jogl-library-path-windows-amd64" if="is-windows-amd64">
		<property name="jogl.library.path" value="lib/jogl/native/windows-amd64/" />
	</target>
	<target name="set-jogl-library-path-windows-i586" if="is-windows-i586">
		<property name="jogl.library.path" value="lib/jogl/native/windows-i586/" />
	</target>
	<target name="set-jogl-library-path-macosx-universal" if="is-macosx-universal">
		<property name="jogl.library.path" value="lib/jogl/native/macosx-universal/" />
	</target>
	<target name="set-jogl-library-path-macosx-ppc" if="is-macosx-ppc">
		<property name="jogl.library.path" value="lib/jogl/native/macosx-ppc/" />
	</target>
	<target name="set-jogl-library-path" depends="set-jogl-library-path-linux-i586,set-jogl-library-path-linux-amd64,set-jogl-library-path-macosx-universal,set-jogl-library-path-macosx-ppc,set-jogl-library-path-windows-i586,set-jogl-library-path-windows-amd64,check-java-version" description="Sets the library path with JOGL binaries">
		<echo message="jogl.library.path: ${jogl.library.path}" />
	</target>
	<condition property="eclipse-setup-not-ok">
		<not>
		    <isset property="eclipse-setup-ok"/>
		</not>
	</condition>
	<target name="setup-eclipse" depends="set-jogl-library-path" if="eclipse-setup-not-ok" description="Generates the .classpath file of the Eclipse project including OS and architecture dependencies">
		<pathconvert property="os-specific-jogl.library.path">
			<path location="${jogl.library.path}" />
		</pathconvert>
		<!-- TODO: maybe convert the other paths if necessary for Windows -->
		<echo file=".classpath"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
			<classpath>
			    <classpathentry kind="src" path=""/>
			    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/JavaSE-1.6"/>
			    <classpathentry kind="lib" path="lib/pss/CodecJOrbis.jar"/>
			    <classpathentry kind="lib" path="lib/pss/LibraryJavaSound.jar"/>
			    <classpathentry kind="lib" path="lib/pss/SoundSystem.jar"/>
			    <classpathentry kind="lib" path="lib/jogl/gluegen-rt.jar">
			        <attributes>
			            <attribute name="org.eclipse.jdt.launching.CLASSPATH_ATTR_LIBRARY_PATH_ENTRY" value="${os-specific-jogl.library.path}"/>
			        </attributes>
			    </classpathentry>
			    <classpathentry kind="lib" path="lib/jogl/jogl.jar">
			        <attributes>
			            <attribute name="org.eclipse.jdt.launching.CLASSPATH_ATTR_LIBRARY_PATH_ENTRY" value="${os-specific-jogl.library.path}"/>
			        </attributes>
			    </classpathentry>
			    <classpathentry kind="lib" path="lib/fettle/fettle-0.4.5.jar"/>
			    <classpathentry kind="lib" path="lib/google-collect/guava-r08.jar"/>
			    <classpathentry kind="lib" path="lib/mockachino/mockachino-full-0.3.1.jar"/>
			    <classpathentry kind="lib" path="lib/ardor3d/ardor3d-animation-0.8-SNAPSHOT.jar"/>
			    <classpathentry kind="lib" path="lib/ardor3d/ardor3d-awt-0.8-SNAPSHOT.jar"/>
			    <classpathentry kind="lib" path="lib/ardor3d/ardor3d-collada-0.8-SNAPSHOT.jar"/>
			    <classpathentry kind="lib" path="lib/ardor3d/ardor3d-core-0.8-SNAPSHOT.jar"/>
			    <classpathentry kind="lib" path="lib/ardor3d/ardor3d-extras-0.8-SNAPSHOT.jar"/>
			    <classpathentry kind="lib" path="lib/ardor3d/ardor3d-jogl-0.8-SNAPSHOT.jar"/>
			    <classpathentry kind="lib" path="lib/ardor3d/ardor3d-ui-0.8-SNAPSHOT.jar"/>
			    <classpathentry kind="output" path=""/>
			</classpath>]]>
		</echo>
		<!-- Sets this property to avoid generating the .classpath file several times at runtime -->
		<property name="eclipse-setup-ok" value="true" />
    </target>
	<!-- ================================================================= -->
	<!-- Compile                                                           -->
	<!-- ================================================================= -->
	<target name="compile" depends="set-jogl-library-path" description="Compiles the source code">
	    <javac srcdir="${srcdir}"       	   
	           destdir="${destdir}"
	           debug="on" >
	    	<classpath refid="project.class.path"/>
	        <include name="**/*.java"/>
	    </javac>
	</target>
	<!-- =================================================================== -->
	<!-- Build                                                               -->
	<!-- =================================================================== -->
	<target name="build" depends="clean,compile,dist" description="Performs a clean build of the source code and create the JAR"/>
	<!-- ================================================================= -->
	<!-- Dist                                                              -->
	<!-- ================================================================= -->
	<target name="dist" depends="compile" description="Creates and signs the java archives">
		<jar destfile="${destdir}/${jfpsm-jar-filename}" basedir="${destdir}" 
			includes="**/*.class" 
			compress="false">
			<exclude name="**/gpl.txt" />
			<!-- the collada models are not yet used -->
			<exclude name="**/dae/*" />
			<!-- ANT file -->
			<exclude name="**/build.xml" />
			<manifest>
				<attribute name="Main-Class" value="${jfpsm-main-class}"/>
			</manifest>
		</jar>
		<jar destfile="${destdir}/${tuer-jar-filename}" basedir="${destdir}" 
			includes="**/*.class"
			compress="false">
			<include name="**/*.bmp" />
			<include name="**/*.png" />
			<include name="**/*.jpg" />
			<include name="**/*.fnt" />
			<include name="**/controls.txt" />
			<include name="**/credits.txt" />
			<include name="**/sounds/*.ogg" />
			<!-- TUER does not need JFPSM classes -->
			<exclude name="**/jfpsm/*.class" />
			<exclude name="**/connection/*.class" />
			<!-- the collada models -->
			<!--<include name="**/dae/*.dae" />-->
			<include name="**/abin/*.abin" />
			<exclude name="**/gpl.txt" />
			<!-- ANT file -->
			<exclude name="**/build.xml" />
			<!-- miscellaneous libraries -->
			<exclude name="**/lib/**" />
			<manifest>
				<attribute name="Main-Class" value="${tuer-main-class}"/>
			</manifest>
		</jar>
		<delete file="${keystore}" failonerror="false" />
		<input message="Please enter the store pass:" addproperty="storepass"/>
		<genkey alias="${alias}" storepass="${storepass}" keystore="${keystore}" >
			<dname>
				<param name="CN" value="${vendor}"/>
				<param name="OU" value="Engineer"/>
				<param name="O"  value="FGF"/>
				<param name="C"  value="FR"/>
				<param name="L"  value="PARIS"/>
				<param name="S"  value="FRANCE"/>
			</dname>
		</genkey>
		<!-- copy these JARs into the local destination directory -->		
		<copy todir="${destdir}" flatten="true">
			<path refid="project.lib.path"/>
		</copy>
		<!-- copy these JARs to host JOGL and GlueGen on your own server -->
		<copy file="lib/jogl/jogl-natives-linux-amd64.jar" todir="${destdir}"/>
		<copy file="lib/jogl/jogl-natives-linux-i586.jar" todir="${destdir}"/>
		<copy file="lib/jogl/jogl-natives-macosx-ppc.jar" todir="${destdir}"/>
		<copy file="lib/jogl/jogl-natives-macosx-universal.jar" todir="${destdir}"/>
		<copy file="lib/jogl/jogl-natives-windows-amd64.jar" todir="${destdir}"/>
		<copy file="lib/jogl/jogl-natives-windows-i586.jar" todir="${destdir}"/>
		<copy file="lib/jogl/gluegen-rt-natives-linux-amd64.jar" todir="${destdir}"/>
		<copy file="lib/jogl/gluegen-rt-natives-linux-i586.jar" todir="${destdir}"/>
		<copy file="lib/jogl/gluegen-rt-natives-macosx-ppc.jar" todir="${destdir}"/>
		<copy file="lib/jogl/gluegen-rt-natives-macosx-universal.jar" todir="${destdir}"/>
		<copy file="lib/jogl/gluegen-rt-natives-windows-amd64.jar" todir="${destdir}"/>
		<copy file="lib/jogl/gluegen-rt-natives-windows-i586.jar" todir="${destdir}"/>
		<signjar alias="${alias}" keystore="${keystore}" storepass="${storepass}" lazy="false" >
		    <path>
		    	<fileset file="${destdir}/fettle-0.4.5.jar" />
		    	<fileset file="${destdir}/guava-r08.jar" />
		    	<fileset file="${destdir}/mockachino-full-0.3.1.jar" />
		    	<fileset file="${destdir}/ardor3d-animation-0.8-SNAPSHOT.jar" />
		    	<fileset file="${destdir}/ardor3d-collada-0.8-SNAPSHOT.jar" />
		    	<fileset file="${destdir}/ardor3d-core-0.8-SNAPSHOT.jar" />
		    	<fileset file="${destdir}/ardor3d-extras-0.8-SNAPSHOT.jar" />
		    	<fileset file="${destdir}/ardor3d-awt-0.8-SNAPSHOT.jar" />
		    	<fileset file="${destdir}/ardor3d-jogl-0.8-SNAPSHOT.jar" />
		    	<fileset file="${destdir}/ardor3d-ui-0.8-SNAPSHOT.jar" />
		      	<fileset file="${destdir}/${tuer-jar-filename}"/>
		        <fileset file="${destdir}/${jfpsm-jar-filename}"/>
		    	<fileset file="${destdir}/CodecJOrbis.jar"/>
		    	<fileset file="${destdir}/LibraryJavaSound.jar"/>
		    	<fileset file="${destdir}/SoundSystem.jar"/>
		    	<fileset file="${destdir}/jogl.jar"/>
		    	<fileset file="${destdir}/jogl-natives-linux-amd64.jar"/>
		    	<fileset file="${destdir}/jogl-natives-linux-i586.jar"/>
		    	<fileset file="${destdir}/jogl-natives-macosx-ppc.jar"/>
		    	<fileset file="${destdir}/jogl-natives-macosx-universal.jar"/>
		    	<fileset file="${destdir}/jogl-natives-windows-amd64.jar"/>
		    	<fileset file="${destdir}/jogl-natives-windows-i586.jar"/>
		    	<fileset file="${destdir}/gluegen-rt.jar"/>
		    	<fileset file="${destdir}/gluegen-rt-natives-linux-amd64.jar"/>
		    	<fileset file="${destdir}/gluegen-rt-natives-linux-i586.jar"/>
		    	<fileset file="${destdir}/gluegen-rt-natives-macosx-ppc.jar"/>
		    	<fileset file="${destdir}/gluegen-rt-natives-macosx-universal.jar"/>
		    	<fileset file="${destdir}/gluegen-rt-natives-windows-amd64.jar"/>
		    	<fileset file="${destdir}/gluegen-rt-natives-windows-i586.jar"/>
		    </path>
		</signjar>
	</target>
	<!-- ================================================================= -->
	<!-- Deploy                                                            -->
	<!-- ================================================================= -->
	<target name="deploy" depends="dist" description="Puts all signed JARs and all JNLP files required for the deployment with Java Web Start into the deployment directory">
		<delete dir="${deploymentdestdir}" includes="**/*.jar" />
		<!-- generate the JNLP files used by Java Web Start -->
		<echo file="${deploymentdestdir}/${tuer-jnlp-filename}"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
			<jnlp spec="1.0+" codebase="${codebase-url}" href="${tuer-jnlp-filename}">
			  <information>
			    <title>TUER</title>
			    <vendor>${vendor}</vendor> 
			    <homepage href="${homepage-url}"/>
			    <description>Small Quake-like written in Java + JOGL</description>
			    <description kind="short">kill them all!!</description>
			    <icon href="tuerLogo.png"/>
			    <icon kind="splash" href="tuerLogo.png"/>
			    <offline-allowed/>
			  </information>
			  <security> 
			    <all-permissions />
			  </security>
			  <update check="always" policy="always"/>
			  <resources>
			    <j2se version="1.6+" href="http://java.sun.com/products/autodl/j2se" initial-heap-size="32m" max-heap-size="256m" java-vm-args="-XX:MaxDirectMemorySize=128M"/>  
			    <property name="sun.java2d.noddraw" value="true"/>
			    <jar href="${tuer-jar-filename}" download="eager" main="true"/>
			    <jar href="ardor3d-animation-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-collada-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-core-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-extras-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-awt-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-jogl-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-ui-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="fettle-0.4.5.jar" download="eager" main="false"/>
			    <jar href="guava-r08.jar" download="eager" main="false"/>
			    <jar href="mockachino-full-0.3.1.jar" download="eager" main="false"/>
			    <jar href="CodecJOrbis.jar" download="eager" main="false"/>
			    <jar href="LibraryJavaSound.jar" download="eager" main="false"/>
			    <jar href="SoundSystem.jar" download="eager" main="false"/>
			    <jar href="jogl.jar" download="eager" main="false"/>
			    <jar href="gluegen-rt.jar" download="eager" main="false"/>
			  </resources>			  
			  <resources os="Linux" arch="i386">
			    <nativelib href = "jogl-natives-linux-i586.jar" />
			    <nativelib href = "gluegen-rt-natives-linux-i586.jar" />
			  </resources>
			  <resources os="Linux" arch="x86">
			    <nativelib href = "jogl-natives-linux-i586.jar" />
			    <nativelib href = "gluegen-rt-natives-linux-i586.jar" />
			  </resources>
			  <resources os="Linux" arch="amd64">
			    <nativelib href = "jogl-natives-linux-amd64.jar" />
			    <nativelib href = "gluegen-rt-natives-linux-amd64.jar" />
			  </resources>
			  <resources os="Linux" arch="x86_64">
			    <nativelib href = "jogl-natives-linux-amd64.jar" />
			    <nativelib href = "gluegen-rt-natives-linux-amd64.jar" />
			  </resources>
			  <resources os="Mac OS X" arch="ppc">
			    <nativelib href = "jogl-natives-macosx-ppc.jar" />
			    <nativelib href = "gluegen-rt-natives-macosx-ppc.jar" />
			  </resources>
			  <resources os="Mac OS X" arch="i386">
			    <nativelib href = "jogl-natives-macosx-universal.jar" />
			    <nativelib href = "gluegen-rt-natives-macosx-universal.jar" />
			  </resources>
			  <resources os="Mac OS X" arch="x86_64">
			    <nativelib href = "jogl-natives-macosx-universal.jar" />
			    <nativelib href = "gluegen-rt-natives-macosx-universal.jar" />
			  </resources>
			  <resources os="Windows" arch="x86">
			    <nativelib href = "jogl-natives-windows-i586.jar" />
			    <nativelib href = "gluegen-rt-natives-windows-i586.jar" />
			  </resources>
			  <resources os="Windows" arch="amd64">
			    <nativelib href = "jogl-natives-windows-amd64.jar" />
			    <nativelib href = "gluegen-rt-natives-windows-amd64.jar" />
			  </resources>
			  <resources os="Windows" arch="x86_64">
			    <nativelib href = "jogl-natives-windows-amd64.jar" />
			    <nativelib href = "gluegen-rt-natives-windows-amd64.jar" />
			  </resources>
			  <application-desc main-class="${tuer-main-class}" />
			</jnlp>
			]]>
		</echo>
		<echo file="${deploymentdestdir}/${jfpsm-jnlp-filename}"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
			<jnlp spec="1.0+" codebase="${codebase-url}" href="${jfpsm-jnlp-filename}">
			  <information>
			    <title>JFPSM</title>
			    <vendor>${vendor}</vendor> 
			    <homepage href="${homepage-url}"/>
			    <description>Java First Person Shooter Maker</description>
			    <description kind="short">JFPSM</description>
			    <offline-allowed/>
			  </information>
			  <security> 
			    <all-permissions />
			  </security>
			  <update check="always" policy="always"/>
			  <resources>
			    <j2se version="1.6+" href="http://java.sun.com/products/autodl/j2se" initial-heap-size="32m" max-heap-size="256m" java-vm-args="-XX:MaxDirectMemorySize=128M"/>  
			    <property name="sun.java2d.noddraw" value="true"/>
			    <property name="sun.awt.noerasebackground" value="true"/>
			    <jar href="${jfpsm-jar-filename}" download="eager" main="true"/>
			    <jar href="ardor3d-animation-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-collada-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-core-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-awt-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-jogl-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="ardor3d-ui-0.8-SNAPSHOT.jar" download="eager" main="false"/>
			    <jar href="fettle-0.4.5.jar" download="eager" main="false"/>
			    <jar href="guava-r08.jar" download="eager" main="false"/>
			    <jar href="mockachino-full-0.3.1.jar" download="eager" main="false"/>
			    <jar href="CodecJOrbis.jar" download="eager" main="false"/>
			    <jar href="LibraryJavaSound.jar" download="eager" main="false"/>
			    <jar href="SoundSystem.jar" download="eager" main="false"/>
			    <jar href="jogl.jar" download="eager" main="false"/>
			    <jar href="gluegen-rt.jar" download="eager" main="false"/>
			  </resources>
			  <resources os="Linux" arch="i386">
			    <nativelib href = "jogl-natives-linux-i586.jar" />
			    <nativelib href = "gluegen-rt-natives-linux-i586.jar" />
			  </resources>
			  <resources os="Linux" arch="x86">
			    <nativelib href = "jogl-natives-linux-i586.jar" />
			    <nativelib href = "gluegen-rt-natives-linux-i586.jar" />
			  </resources>
			  <resources os="Linux" arch="amd64">
			    <nativelib href = "jogl-natives-linux-amd64.jar" />
			    <nativelib href = "gluegen-rt-natives-linux-amd64.jar" />
			  </resources>
			  <resources os="Linux" arch="x86_64">
			    <nativelib href = "jogl-natives-linux-amd64.jar" />
			    <nativelib href = "gluegen-rt-natives-linux-amd64.jar" />
			  </resources>
			  <resources os="Mac OS X" arch="ppc">
			    <nativelib href = "jogl-natives-macosx-ppc.jar" />
			    <nativelib href = "gluegen-rt-natives-macosx-ppc.jar" />
			  </resources>
			  <resources os="Mac OS X" arch="i386">
			    <nativelib href = "jogl-natives-macosx-universal.jar" />
			    <nativelib href = "gluegen-rt-natives-macosx-universal.jar" />
			  </resources>
			  <resources os="Mac OS X" arch="x86_64">
			    <nativelib href = "jogl-natives-macosx-universal.jar" />
			    <nativelib href = "gluegen-rt-natives-macosx-universal.jar" />
			  </resources>
			  <resources os="Windows" arch="x86">
			    <nativelib href = "jogl-natives-windows-i586.jar" />
			    <nativelib href = "gluegen-rt-natives-windows-i586.jar" />
			  </resources>
			  <resources os="Windows" arch="amd64">
			    <nativelib href = "jogl-natives-windows-amd64.jar" />
			    <nativelib href = "gluegen-rt-natives-windows-amd64.jar" />
			  </resources>
			  <resources os="Windows" arch="x86_64">
			    <nativelib href = "jogl-natives-windows-amd64.jar" />
			    <nativelib href = "gluegen-rt-natives-windows-amd64.jar" />
			  </resources>
			  <application-desc main-class="${jfpsm-main-class}" />
			</jnlp>
			]]>
		</echo>
		<!-- generate the manifest file for Chrome web store -->
		<echo file="${deploymentdestdir}/${tuer-chrome-web-store-manifest-filename}"><![CDATA[{
			  "name": "TUER",
			  "description": "small FPS taking place in a museum (alpha version)",
			  "version": "0.0.0.4",
			  "app": {			    
			    "launch": {
			      "web_url": "${homepage-url}"
			    }
			  },
			  "icons": {
			    "128": "${tuer-chrome-web-store-icon-filename}"
			  },
			  "permissions": [
			  ]
			}		    
		    ]]>
		</echo>
		<!-- generate the ZIP file for Chrome web store -->
		<zip destFile="${deploymentdestdir}/${tuer-chrome-web-store-zip-filename}" >
			<zipfileset dir="${deploymentdestdir}" includes="${tuer-chrome-web-store-manifest-filename}" fullpath="myapp/${tuer-chrome-web-store-manifest-filename}" />
			<zipfileset dir="${deploymentdestdir}" includes="${tuer-chrome-web-store-icon-filename}" fullpath="myapp/${tuer-chrome-web-store-icon-filename}" />
		</zip>
		<copy file="${destdir}/fettle-0.4.5.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/guava-r08.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/mockachino-full-0.3.1.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/ardor3d-animation-0.8-SNAPSHOT.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/ardor3d-collada-0.8-SNAPSHOT.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/ardor3d-core-0.8-SNAPSHOT.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/ardor3d-extras-0.8-SNAPSHOT.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/ardor3d-awt-0.8-SNAPSHOT.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/ardor3d-jogl-0.8-SNAPSHOT.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/ardor3d-ui-0.8-SNAPSHOT.jar" todir="${deploymentdestdir}"/>		
		<copy file="${destdir}/${tuer-jar-filename}" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/${jfpsm-jar-filename}" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/CodecJOrbis.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/LibraryJavaSound.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/SoundSystem.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/jogl.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/jogl-natives-linux-amd64.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/jogl-natives-linux-i586.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/jogl-natives-macosx-ppc.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/jogl-natives-macosx-universal.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/jogl-natives-windows-amd64.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/jogl-natives-windows-i586.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/gluegen-rt.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/gluegen-rt-natives-linux-amd64.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/gluegen-rt-natives-linux-i586.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/gluegen-rt-natives-macosx-ppc.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/gluegen-rt-natives-macosx-universal.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/gluegen-rt-natives-windows-amd64.jar" todir="${deploymentdestdir}"/>
		<copy file="${destdir}/gluegen-rt-natives-windows-i586.jar" todir="${deploymentdestdir}"/>
	</target>
	<!-- ================================================================= -->
	<!-- Clean                                                             -->
	<!-- ================================================================= -->
	<target name="clean" description="Deletes the java archive and the .class files">
	  	<delete>
	  		<fileset file="${keystore}" />
	  		<fileset dir="${deploymentdestdir}" includes="**/*.jar" />
	  		<fileset file="${deploymentdestdir}/${tuer-jnlp-filename}" />
	  		<fileset file="${deploymentdestdir}/${jfpsm-jnlp-filename}" />
	  		<fileset file="${deploymentdestdir}/${tuer-chrome-web-store-manifest-filename}" />
	  		<fileset file="${deploymentdestdir}/${tuer-chrome-web-store-zip-filename}" />	  		
	   	    <fileset dir="${destdir}" includes="**/*.class" />	  		
	  		<fileset file="${destdir}/${tuer-jar-filename}" />
	  		<fileset file="${destdir}/${jfpsm-jar-filename}" />
	  		<fileset file="${destdir}/fettle-0.4.5.jar" />
	  		<fileset file="${destdir}/guava-r08.jar" />
	  		<fileset file="${destdir}/mockachino-full-0.3.1.jar" />
	  		<fileset file="${destdir}/ardor3d-animation-0.8-SNAPSHOT.jar" />
	  		<fileset file="${destdir}/ardor3d-collada-0.8-SNAPSHOT.jar" />
	  		<fileset file="${destdir}/ardor3d-core-0.8-SNAPSHOT.jar" />
	  		<fileset file="${destdir}/ardor3d-extras-0.8-SNAPSHOT.jar" />
	  		<fileset file="${destdir}/ardor3d-awt-0.8-SNAPSHOT.jar" />
	  		<fileset file="${destdir}/ardor3d-jogl-0.8-SNAPSHOT.jar" />
	  		<fileset file="${destdir}/ardor3d-ui-0.8-SNAPSHOT.jar" />
	  		<fileset file="${destdir}/CodecJOrbis.jar" />
	  		<fileset file="${destdir}/LibraryJavaSound.jar" />
	  		<fileset file="${destdir}/SoundSystem.jar" />
	  		<fileset file="${destdir}/jogl.jar"/>
	  		<fileset file="${destdir}/jogl-natives-linux-amd64.jar"/>
	  		<fileset file="${destdir}/jogl-natives-linux-i586.jar"/>
	  		<fileset file="${destdir}/jogl-natives-macosx-ppc.jar"/>
	  		<fileset file="${destdir}/jogl-natives-macosx-universal.jar"/>
	  		<fileset file="${destdir}/jogl-natives-windows-amd64.jar"/>
	  		<fileset file="${destdir}/jogl-natives-windows-i586.jar"/>
	  		<fileset file="${destdir}/gluegen-rt.jar"/>
	  		<fileset file="${destdir}/gluegen-rt-natives-linux-amd64.jar"/>
	  		<fileset file="${destdir}/gluegen-rt-natives-linux-i586.jar"/>
	  		<fileset file="${destdir}/gluegen-rt-natives-macosx-ppc.jar"/>
	  		<fileset file="${destdir}/gluegen-rt-natives-macosx-universal.jar"/>
	  		<fileset file="${destdir}/gluegen-rt-natives-windows-amd64.jar"/>
	  		<fileset file="${destdir}/gluegen-rt-natives-windows-i586.jar"/>
	   	</delete>
	</target>
	<!-- =================================================================== -->
	<!-- Run Targets                                                         -->
	<!-- =================================================================== -->  
	<target name="run-jfpsm" depends="set-jogl-library-path" description="Runs JFPSM">
		<java classname="${jfpsm-main-class}"
			  fork="true"
			  dir="${destdir}"
			  failonerror="true">
			<classpath refid="project.class.path"/>
			<jvmarg value="-Xmx128m"/>
		</java>
	</target>
	<target name="run-tuer" depends="set-jogl-library-path" description="Runs TUER">
		<java classname="${tuer-main-class}"
			  fork="true"
			  dir="${destdir}"
			  failonerror="true">
			<classpath refid="project.class.path"/>
		    <jvmarg value="-Xmx256m"/>
		    <jvmarg value="-XX:MaxDirectMemorySize=128M"/>
		    <jvmarg value="-Djava.library.path=${jogl.library.path}"/>
	    </java>
	</target>
</project>